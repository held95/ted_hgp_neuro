<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Editor de Horas Neuro</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
    }
    tr.selected {
        background-color: #cce5ff;
    }
    #controls {
        margin: 15px 0;
    }
    input, button {
        padding: 8px;
        font-size: 14px;
    }
</style>
</head>
<body>

<h2>Resumo Plantão - HOSP_NCR</h2>

<div id="controls">
    <input type="number" step="0.01" id="inputHoras" placeholder="Digite o valor de Horas">
    <button id="btnSalvar">Salvar Alteração</button>
</div>

<table id="tabelaResumo">
    <thead>
        <tr>
            <th>Nome</th>
            <th>CRM</th>
            <th>Horas</th>
        </tr>
    </thead>
    <tbody>
        <!-- Dados serão preenchidos pelo JS -->
    </tbody>
</table>

<script>
let dados = {
    "TED_teste": [
        { "Nome": "Alan Pires", "CRM": 101999, "Valor ELET": 8375, "Valor Amb": 0.0, "Horas": 0 },
        { "Nome": "Alexandre De Jesus Felix", "CRM": 205353, "Valor ELET": 33500, "Valor Amb": 2852.49, "Horas": 0 }
    ],
    "Dados_TED_Mutirao": [
        { "CRM": 101999, "Nome": "Alan Pires", "Horas Neuro": 0 },
        { "CRM": 205353, "Nome": "Alexandre De Jesus Felix", "Horas Neuro": 0 }
    ]
};

function renderTabela() {
    const tbody = document.querySelector("#tabelaResumo tbody");
    tbody.innerHTML = "";
    dados.TED_teste.forEach((item, index) => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${item.Nome}</td>
            <td>${item.CRM}</td>
            <td>${item.Horas}</td>
        `;
        tr.addEventListener("click", function() {
            this.classList.toggle("selected");
        });
        tbody.appendChild(tr);
    });
}

document.getElementById("btnSalvar").addEventListener("click", function() {
    const valor = parseFloat(document.getElementById("inputHoras").value);
    if (isNaN(valor)) {
        alert("Digite um valor válido.");
        return;
    }

    const linhasSelecionadas = document.querySelectorAll("#tabelaResumo tbody tr.selected");
    linhasSelecionadas.forEach(linha => {
        const crm = parseInt(linha.cells[1].textContent);
        // Atualiza na aba TED_teste
        let registroResumo = dados.TED_teste.find(r => r.CRM === crm);
        if (registroResumo) registroResumo.Horas = valor;

        // Atualiza na aba Dados_TED_Mutirao
        let registroMutirao = dados.Dados_TED_Mutirao.find(r => r.CRM === crm);
        if (registroMutirao) registroMutirao["Horas Neuro"] = valor;

        // Atualiza na tabela
        linha.cells[2].textContent = valor;
    });

    alert("Alterações salvas com sucesso!");
});

renderTabela();
</script>

</body>
</html>
